{"version":3,"sources":["webpack:///webpack/bootstrap e6b0c76a778f03743508","webpack:///./logic/move_worker.js","webpack:///./logic/logic_bridge.js","webpack:///./logic/ai_new.js","webpack:///./logic/board_eval.js","webpack:///./logic/ai.js"],"names":["LogicBridge","require","Ai","self","onmessage","e","specMoves","data","specialMoves","testBoard","dupe","board","pieces","depth","bestMove","findBestMove","workerResult","moveData","Object","assign","move","checkmate","enPassant","castle","postMessage","module","exports","ai","moves","allLegalMoves","findAllPieces","length","side","currentSide","i","currentNode","score","convert","from","Math","floor","to","convertBoard","boardString","n","j","m","piece","type","split","toUpperCase","pos","test","color","positions","push","concat","findAllLegalMovesByPiece","filter","inCheck","newBoard","makeMove","kingPos","findPiece","hasAttackers","position","bishopsQueensCheck","currentPos","checkObstruction","toLowerCase","inBounds","rooksQueensCheck","knightChecks","pawnChecks","kingChecks","allMoves","pawnMoves","rookMoves","knightMoves","bishopMoves","kingMoves","queenMoves","legalDirs","captureDirs","capturePos","canTake","abs","checkCastle","min","max","queenSideCastle","emptyBetween","kingSideCastle","MATERIAL","r","R","N","b","B","q","Q","k","K","p","P","BoardEval","evaluateMove","evaluateBoard","materialScore","positionalScore","piecePosition","reduce","sum","centralVert","centralHor","vertDist","horDist","central","pawnPosition","knightPosition","rookPosition","bishopPosition","queenPosition","kingPosition","converted","legalMoves","returnPieces","forEach","row","square","testSquare","parseSquare","allSquares","canMove","map","parseMoveClusters","array","result","subArray","y","x","pieceInfo","defended","toX","toY","notInCheck","checkMove","selected","dx","dy","checkPawnCaptures","pawn","oppColor","dX","dY","status","afterMove","testMove","king","findKing","findAttackers","colorToCheck","sameSide","yDir","left","right","returnResult","coord","step","start","duped","target","checkPawnObstruction","castleQueenSideStatus","castleKingSideStatus","xStep","yStep","castleRook","checkEnPassant","rightSide","leftSide","captureEnPassant"],"mappings":"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","file":"e6b0c76a778f03743508.worker.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap e6b0c76a778f03743508","const LogicBridge = require('./logic_bridge.js');\nconst Ai = require('./ai.js');\n\nself.onmessage = function (e) {\n  let specMoves = e.data.data.specialMoves;\n  let testBoard = Ai.dupe(e.data.data.board.pieces);\n  let depth = e.data.data.depth;\n  let bestMove = LogicBridge.findBestMove(testBoard,specMoves,depth);\n  let workerResult = 'Message received!';\n  let moveData = Object.assign({move: [], checkmate: false, enPassant: false, castle: false},bestMove);\n  postMessage(moveData);\n};\n\n\n\n// WEBPACK FOOTER //\n// ./logic/move_worker.js","// const Ai = require('./ai.js');\nimport Ai from './ai_new.js';\nimport BoardEval from './board_eval.js';\n\n// const BoardNode = require('./board_node.js');\n\nmodule.exports = {\n\n  findBestMove (board, specMoves, depth) {\n    let ai = new Ai(board, specMoves);\n    let moves = ai.allLegalMoves(\n      ai.findAllPieces('b')\n    );\n    if (moves.length === 0) return {checkmate: true, side: specMoves.currentSide};\n    let bestMove = null;\n    for (let i = 0; i < moves.length; i++) {\n      let currentNode = new BoardEval(ai, moves[i], depth);\n      if (currentNode.checkmate) {\n        return {move: currentNode.move, checkmate: true};\n      } else {\n        bestMove = bestMove ? (currentNode.score > bestMove.score ?\n          currentNode : bestMove) : currentNode;\n      }\n    }\n    return {move: this.convert(bestMove.move)};\n  },\n\n  convert (move) {\n    let from = [(move[0] % 10) - 1, Math.floor(move[0] / 10) - 1];\n    let to = [(move[1] % 10) - 1, Math.floor(move[1] / 10) - 1];\n    return [from,to];\n  }\n\n  // findBestMove (board,specMoves,depth) {\n  //   let moves = Ai.parseMoveClusters(\n  //                 Ai.findAllPieces(board,specMoves.currentSide)\n  //                 .map(piece=> Ai.findAllLegalMovesByPiece(piece,board,specMoves))\n  //               );\n  //   if (moves.length === 0) return {checkmate: true, side: specMoves.currentSide};\n  //   debugger\n  //   let bestMove = null;\n  //   moves.forEach(move => {\n  //     let currentNode = new BoardNode(move,board,specMoves,depth);\n  //     if (currentNode.checkmate) {\n  //       return {move: currentNode.move, checkmate: true};\n  //     }\n  //     bestMove = bestMove ?\n  //       (currentNode.score > bestMove.score ?\n  //         currentNode : bestMove) : currentNode;\n  //   });\n  //   return {move: bestMove.move};\n  // }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./logic/logic_bridge.js","export default class Ai {\n  constructor (board,specialMoves) {\n    this.specialMoves = specialMoves;\n    this.board = this.convertBoard(board);\n  }\n\n  //RNBQKBNRPPPPPPPP----------------\n  //----------------pppppppprnbqkbnr\n  convertBoard (board) {\n    let boardString = '----------';\n    for (let i = 0, n = board.length; i < n; i++) {\n      boardString += '-';\n      for (let j = 0, m = board[i].length; j < m; j++) {\n        let piece = board[i][j][0];\n        let type = piece.split('-')[1];\n        if (type === 'l') {\n          boardString += '-';\n        } else if (piece.split('-')[0] === 'b') {\n          boardString += type.toUpperCase();\n        } else {\n          boardString += type;\n        }\n      }\n      boardString += '-';\n    }\n    boardString += '----------';\n    return boardString;\n  }\n\n  color (pos,board = this.board) {\n    if (/[a-z]/.test(board[pos])) {\n      return 'w';\n    } else {\n      return 'b';\n    }\n  }\n\n  findAllPieces (color, board = this.board) {\n    let positions = [];\n    for (let i = 0, n = board.length; i < n; i++) {\n      let piece = board[i];\n      if (piece !== '-' && this.color(i) === color) {\n        positions.push(i);\n      }\n    }\n    return positions;\n  }\n\n  allLegalMoves (positions, board = this.board) {\n    let moves = [];\n    for (let i = 0; i < positions.length; i++) {\n      moves = moves.concat(this.findAllLegalMovesByPiece(positions[i],board));\n    }\n    return moves.filter(move => !this.inCheck(move,board));\n  }\n\n  inCheck (move, board = this.board, color = 'b') {\n    let newBoard = this.makeMove(move, board);\n    let kingPos = this.findPiece('k', color, board)[0];\n    return this.hasAttackers(kingPos, newBoard, color);\n  }\n\n  findPiece (piece, color, board = this.board) {\n    if (color === 'b') piece = piece.toUpperCase();\n    let pos = [];\n    for (let i = 0; i < 100; i++) {\n      if (board[i] === piece) {\n        if (piece === 'K' || piece === 'k' ||\n          piece === 'Q' || piece === 'q') {\n            return [i];\n          }\n        pos.push(i);\n      }\n    }\n    return pos;\n  }\n\n  hasAttackers (position, board = this.board, color = 'b') {\n    let bishopsQueensCheck = [-11,-9,11,9];\n    for (let i = 0; i < bishopsQueensCheck.length; i++) {\n      let currentPos = position + bishopsQueensCheck[i];\n      while (this.checkObstruction(currentPos, board)) {\n        currentPos += bishopsQueensCheck[i];\n      }\n      let piece = board[currentPos] ? board[currentPos].toLowerCase() : '-';\n      if (this.inBounds(currentPos) && (piece === 'b' || piece === 'q') &&\n        this.color(currentPos,board) !== color) {\n          return true;\n      }\n    }\n\n    let rooksQueensCheck = [-1,1,-10,10];\n    for (let i = 0; i < rooksQueensCheck.length; i++) {\n      let currentPos = position + rooksQueensCheck[i];\n      while (this.checkObstruction(currentPos, board)) {\n        currentPos += rooksQueensCheck[i];\n      }\n      let piece = board[currentPos] ? board[currentPos].toLowerCase() : '-';\n      if (this.inBounds(currentPos) && (piece === 'r' || piece === 'q') &&\n        this.color(currentPos,board) !== color) {\n          return true;\n      }\n    }\n\n    let knightChecks = [-12,-21,-19,-8,12,21,19,8];\n    for (let i = 0; i < knightChecks.length; i++) {\n      let currentPos = position + knightChecks[i];\n      let piece = board[currentPos] ? board[currentPos].toLowerCase() : '-';\n      if (this.inBounds(currentPos) && piece === 'n' &&\n        this.color(currentPos,board) !== color) {\n          return true;\n      }\n    }\n\n    let pawnChecks = [\n      11 * (color === 'w' ? - 1 : 1),\n      9 * (color === 'w' ? - 1 : 1)\n    ];\n    for (let i = 0; i < pawnChecks.length; i++) {\n      let currentPos = position + pawnChecks[i];\n      let piece = board[currentPos] ? board[currentPos].toLowerCase() : '-';\n      if (this.inBounds(currentPos) && piece === 'p' &&\n        this.color(currentPos,board) !== color) {\n          return true;\n      }\n    }\n\n    let kingChecks = [-1,-11,-10,-9,1,11,10,9];\n    for (let i = 0; i < kingChecks.length; i++) {\n      let currentPos = position + kingChecks[i];\n      let piece = board[currentPos] ? board[currentPos].toLowerCase() : '-';\n      if (this.inBounds(currentPos) && piece === 'k' &&\n        this.color(currentPos,board) !== color) {\n          return true;\n      }\n    }\n\n    return false;\n  }\n\n  makeMove (move, board = this.board) {\n    let newBoard = \"\";\n    for (let i = 0; i < 100; i++) {\n      if (i === move[0]) {\n        newBoard += '-';\n      } else if (i === move[1]) {\n        newBoard += board[move[0]];\n      } else {\n        newBoard += board[i];\n      }\n    }\n    return newBoard;\n  }\n\n  findAllLegalMovesByPiece (position, board = this.board) {\n    let allMoves;\n    switch (board[position].toLowerCase()) {\n      case 'p':\n        allMoves = this.pawnMoves(position, board);\n        break;\n      case 'r':\n        allMoves = this.rookMoves(position, board);\n        break;\n      case 'n':\n        allMoves = this.knightMoves(position, board);\n        break;\n      case 'b':\n        allMoves = this.bishopMoves(position, board);\n        break;\n      case 'k':\n        allMoves = this.kingMoves(position, board);\n        break;\n      case 'q':\n        allMoves = this.queenMoves(position, board);\n        break;\n      default:\n        allMoves = [];\n    }\n    return allMoves;\n  }\n\n  inBounds (pos) {\n    return (pos > 9 && pos < 90 && pos % 10 !== 0 && pos % 10 !== 9);\n  }\n\n  checkObstruction (pos, board = this.board) {\n    return board[pos] === '-' && this.inBounds(pos);\n  }\n\n  canTake (color, pos, board = this.board) {\n    return this.inBounds(pos) && this.color(pos) !== color && board[pos] !== '-';\n  }\n\n  pawnMoves (position, board = this.board) {\n    let allMoves = [];\n    let color = this.color(position,board);\n    let legalDirs = [\n      10 * (color === 'w' ? - 1 : 1)\n    ];\n    if ((color === 'w' && position > 70) || (color === 'b' && position < 30)) {\n      legalDirs.push(20 * (color === 'w' ? - 1 : 1));\n    }\n    for (let i = 0; i < legalDirs.length; i++) {\n      let currentPos = position + legalDirs[i];\n      if (this.checkObstruction(currentPos)) {\n        allMoves.push([position,currentPos]);\n      }\n    }\n\n    let captureDirs = [\n      11 * (color === 'w' ? - 1 : 1),\n      9 * (color === 'w' ? - 1 : 1)\n    ];\n    for (let i = 0; i < captureDirs.length; i++) {\n      let capturePos = position + captureDirs[i];\n      if (this.inBounds(capturePos) && this.canTake(color, capturePos)) {\n        allMoves.push([position,capturePos]);\n      }\n    }\n    // Remember to test again for en passant\n    if (this.specialMoves.enPassant &&\n      Math.abs(this.specialMoves - position) === 1) {\n        allMoves.push([position,this.specialMoves.enPassant +\n          (10 * color === 'w' ? -1 : 1)]);\n    }\n    return allMoves;\n  }\n\n  rookMoves (position, board = this.board) {\n    let allMoves = [];\n    let legalDirs = [-1,1,-10,10];\n    let color = this.color(position,board);\n    for (let i = 0; i < legalDirs.length; i++) {\n      let currentPos = position + legalDirs[i];\n      while (this.checkObstruction(currentPos)) {\n        allMoves.push([position,currentPos]);\n        currentPos += legalDirs[i];\n      }\n      if (this.inBounds(currentPos) && this.canTake(color, currentPos)) {\n        allMoves.push([position,currentPos]);\n      }\n    }\n    return allMoves;\n  }\n\n  knightMoves (position, board = this.board) {\n    let allMoves = [];\n    let legalDirs = [-12,-21,-19,-8,12,21,19,8];\n    let color = this.color(position,board);\n    for (let i = 0; i < legalDirs.length; i++) {\n      let currentPos = position + legalDirs[i];\n      if (this.checkObstruction(currentPos) ||\n        this.canTake(color, currentPos)) {\n          allMoves.push([position,currentPos]);\n      }\n    }\n    return allMoves;\n  }\n\n  bishopMoves (position, board = this.board) {\n    let allMoves = [];\n    let legalDirs = [-11,11,-9,9];\n    let color = this.color(position,board);\n    for (let i = 0; i < legalDirs.length; i++) {\n      let currentPos = position + legalDirs[i];\n      while (this.checkObstruction(currentPos)) {\n        allMoves.push([position,currentPos]);\n        currentPos += legalDirs[i];\n      }\n      if (this.inBounds(currentPos) && this.canTake(color, currentPos)) {\n        allMoves.push([position,currentPos]);\n      }\n    }\n    return allMoves;\n  }\n\n  kingMoves (position, board = this.board) {\n    let allMoves = [];\n    let legalDirs = [-1,-11,-10,-9,1,11,10,9];\n    let color = this.color(position,board);\n    for (let i = 0; i < legalDirs.length; i++) {\n      let currentPos = position + legalDirs[i];\n      if (this.checkObstruction(currentPos) ||\n        this.canTake(color, currentPos)) {\n          allMoves.push([position,currentPos]);\n      }\n    }\n    allMoves = allMoves.concat(this.checkCastle(board, position));\n    return allMoves;\n  }\n\n  emptyBetween (board,from, to) {\n    // Check horizontal line\n    if (Math.floor(from / 10) === Math.floor(to / 10)) {\n      for (let i = Math.min(from, to); i <= Math.max(from, to); i++) {\n        if (board[i] !== '-') return false;\n      }\n      // Check vertical line\n    } else if (from % 10 === to % 10) {\n      for (let i = Math.min(from, to); i <= Math.max(from, to); i += 10) {\n        if (board[i] !== '-') return false;\n      }\n    } else {\n      // Check diagonal\n      if (Math.abs(from - to) % 11 === 0) {\n        for (let i = Math.min(from, to); i <= Math.max(from, to); i += 11) {\n          if (board[i] !== '-') return false;\n        }\n      } else if (Math.abs(from - to) % 9 === 0) {\n        for (let i = Math.min(from, to); i <= Math.max(from, to); i += 9) {\n          if (board[i] !== '-') return false;\n        }\n      }\n    }\n\n    return true;\n  }\n\n  checkCastle (board, position) {\n    let moves = [];\n    let color = this.board[position] === 15 ? 'b' : 'w';\n    if (this.specialMoves.queenSideCastle) {\n      if (this.emptyBetween(board, position - 1, 12) && color === 'b') {\n        moves.push([position,13]);\n      } else if (this.emptyBetween(board, position - 1, 82)){\n        moves.push([position, 83]);\n      }\n    }\n\n    if (this.specialMoves.kingSideCastle) {\n      if (this.emptyBetween(board, position + 1, 17) && color === 'b') {\n        moves.push([position,17]);\n      } else if (this.emptyBetween(board, position + 1, 87)){\n        moves.push([position, 87]);\n      }\n    }\n    return moves;\n  }\n\n  queenMoves (position, board = this.board) {\n    let allMoves = [];\n    let legalDirs = [-1,1,-10,10,-11,11,-9,9];\n    let color = this.color(position,board);\n    for (let i = 0; i < legalDirs.length; i++) {\n      let currentPos = position + legalDirs[i];\n      while (this.checkObstruction(currentPos)) {\n        allMoves.push([position,currentPos]);\n        currentPos += legalDirs[i];\n      }\n      if (this.inBounds(currentPos) && this.canTake(color, currentPos)) {\n        allMoves.push([position,currentPos]);\n      }\n    }\n    return allMoves;\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./logic/ai_new.js","const MATERIAL = {\n  r: 500,\n  R: -500,\n  n: 300,\n  N: -300,\n  b: 300,\n  B: -300,\n  q: 900,\n  Q: -900,\n  k: 1000,\n  K: -1000,\n  p: 100,\n  P: -100,\n  '-': 0\n};\n\nexport default class BoardEval {\n  constructor (ai, move, depth) {\n    this.ai = ai;\n    this.specialMoves = ai.specialMoves;\n    this.move = move;\n    this.depth = depth;\n    this.checkmate = false;\n    this.color = this.ai.color(move[0], ai.board);\n    this.score = this.evaluateMove(ai.board, move, depth);\n  }\n\n  evaluateMove (board, move, depth) {\n    let newBoard = this.ai.makeMove(move,board);\n    return -this.evaluateBoard(newBoard,'b');\n  }\n\n  evaluateBoard (board,color) {\n    let materialScore = 0;\n    let positionalScore = 0;\n    for (let i = 0, n = board.length; i < n; i++) {\n      let piece = board[i];\n      materialScore += (color === 'w' ? MATERIAL[piece] : -MATERIAL[piece]);\n      positionalScore += this.piecePosition(i,board);\n    }\n    return materialScore + positionalScore;\n  }\n\n  materialScore (board, color) {\n    let score = board.split('').reduce((sum,piece) => {\n      return (sum += MATERIAL[piece]);\n    },0);\n\n    return color === 'w' ? score : -score;\n  }\n\n  central (pos) {\n    let centralVert = pos % 10;\n    let centralHor = Math.floor( pos / 10 );\n    let vertDist = (1 / (Math.abs(4.5 - centralVert) * 2));\n    let horDist = (1 / (Math.abs(4.5 - centralHor) * 2));\n    return (vertDist + horDist) / 2;\n  }\n\n  pawnPosition (pos, board) {\n    return this.central(pos) * MATERIAL[board[pos]];\n  }\n\n  rookPosition (pos, board) {\n    return this.ai.rookMoves(pos, board).length * MATERIAL[board[pos]] * 0.02;\n  }\n\n  inBounds (pos) {\n    return (pos > 9 && pos < 90 && pos % 10 !== 0 && pos % 10 !== 9);\n  }\n\n  knightPosition (pos, board) {\n    return this.central(pos) * MATERIAL[board[pos]];\n  }\n\n  bishopPosition (pos, board) {\n    return this.ai.bishopMoves(pos, board).length * MATERIAL[board[pos]] * 0.02;\n  }\n\n  queenPosition (pos, board) {\n    return this.ai.queenMoves(pos, board).length * MATERIAL[board[pos]] * 0.02;\n  }\n\n  kingPosition (pos, board) {\n    return 0;\n  }\n\n  piecePosition (pos, board) {\n    switch (board[pos].toLowerCase()) {\n      case 'p':\n        return this.pawnPosition(pos, board);\n      case 'n':\n        return this.knightPosition(pos, board);\n      case 'r':\n        return this.rookPosition(pos, board);\n      case 'b':\n        return this.bishopPosition(pos, board);\n      case 'q':\n        return this.queenPosition(pos, board);\n      case 'k':\n        return this.kingPosition(pos, board);\n      default:\n        return 0;\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./logic/board_eval.js","import Ai from './ai_new.js';\n\nmodule.exports = {\n  specialMoves: {},\n\n  findAllPieces (board,color) {\n    let converted = new Ai(board,this.specialMoves);\n    let legalMoves = converted.allLegalMoves(\n      converted.findAllPieces('b')\n    );\n    let returnPieces = [];\n    board.forEach((row,i)=>{\n      row.forEach((square,j)=>{\n        let testSquare = this.parseSquare(board,i,j);\n        if (testSquare.side === color) {\n          returnPieces.push(testSquare);\n        }\n      });\n    });\n    return returnPieces;\n  },\n\n  findAllLegalMovesByPiece (piece, board, specMoves) {\n    let allSquares = [];\n    let allMoves;\n    for (let i=0;i<8;i++) {\n      for (let j=0;j<8;j++) {\n        allSquares.push([j,i]);\n      }\n    }\n    if (piece.type === 'r') {\n      allMoves = allSquares.filter(square=> {\n        return this.rookMoves(piece.pos, square[0], square[1]);\n      }).filter(square=> {\n        return this.canMove(square[0], square[1], board, piece.pos,specMoves);\n      }).map(move => [piece.pos,move]);\n    }\n\n    if (piece.type === 'n') {\n      allMoves = allSquares.filter(square=> {\n        return this.knightMoves(piece.pos, square[0], square[1]);\n      }).filter(square=> {\n        return this.canMove(square[0], square[1], board, piece.pos,specMoves);\n      }).map(move => [piece.pos,move]);\n    }\n\n    if (piece.type === 'b') {\n      allMoves = allSquares.filter(square=> {\n        return this.bishopMoves(piece.pos, square[0], square[1]);\n      }).filter(square=> {\n        return this.canMove(square[0], square[1], board, piece.pos,specMoves);\n      }).map(move => [piece.pos,move]);\n    }\n\n    if (piece.type === 'q') {\n      allMoves = allSquares.filter(square=> {\n        return this.queenMoves(piece.pos, square[0], square[1]);\n      }).filter(square=> {\n        return this.canMove(square[0], square[1], board, piece.pos,specMoves);\n      }).map(move => [piece.pos,move]);\n    }\n\n    if (piece.type === 'p') {\n      allMoves = allSquares.filter(square=> {\n        return this.pawnMoves(square[0], square[1], piece.pos, board);\n      }).filter(square=> {\n        return this.canMove(square[0], square[1], board, piece.pos,specMoves);\n      }).map(move => [piece.pos,move]);\n    }\n\n    if (piece.type === 'k') {\n      allMoves = allSquares.filter(square=> {\n        return this.kingMoves(piece.pos, square[0], square[1]);\n      }).filter(square=> {\n        return this.canMove(square[0], square[1], board, piece.pos,specMoves);\n      }).map(move => [piece.pos,move]);\n    }\n    return allMoves;\n  },\n\n  parseMoveClusters (array) {\n    let result = [];\n    array.forEach(subArray => {\n      subArray.forEach(move => {\n        result.push(move);\n      });\n    });\n    return result;\n  },\n\n  parseSquare (pieces, y, x) {\n    let pieceInfo = {\n      side: pieces[y][x][0][0],\n      type: pieces[y][x][0][2],\n      pos: [x,y],\n      defended: false\n    };\n    return pieceInfo;\n  },\n\n  canMove(toX, toY, pieces, from,specMoves) {\n    this.specialMoves = specMoves;\n    // if (from[0] === 4 && from[1] === 0 && toX === 5 && toY === 1) debugger\n    if (this.notInCheck(toX, toY, from, pieces)) {\n      if (this.checkMove(toX, toY, pieces, from)) return true;\n    }\n    return false;\n  },\n\n  bishopMoves (selected, toX, toY) {\n    let [x, y] = selected;\n    let dx = toX - x;\n    let dy = toY - y;\n    return (Math.abs(dx) / Math.abs(dy) === 1);\n  },\n\n  rookMoves (selected, toX, toY) {\n    let [x, y] = selected;\n    let dx = toX - x;\n    let dy = toY - y;\n    return (dx === 0 && dy !== 0|| dy === 0 && dx !== 0);\n  },\n\n  queenMoves (selected, toX, toY) {\n    let [x, y] = selected;\n    let dx = toX - x;\n    let dy = toY - y;\n    return (Math.abs(dx) / Math.abs(dy) === 1) ||\n    (dx === 0 && dy !== 0|| dy === 0 && dx !== 0);\n  },\n\n  knightMoves (selected,toX, toY) {\n    const [x, y] = selected;\n    const dx = toX - x;\n    const dy = toY - y;\n    return (Math.abs(dx) === 2 && Math.abs(dy) === 1) ||\n           (Math.abs(dx) === 1 && Math.abs(dy) === 2);\n  },\n\n  kingMoves (selected, toX, toY) {\n    const [x, y] = selected;\n    const dx = toX - x;\n    const dy = toY - y;\n    return ((Math.abs(dx) <= 1 && Math.abs(dy) <= 1) &&\n           (Math.abs(dx) + Math.abs(dy) > 0)) ||\n           (x === 4 && y === 0 && ((toX === 6) || (toX === 2)));\n  },\n\n  checkPawnCaptures (toX, toY, pawn, pieces) {\n    const [x, y] = pawn;\n    const color = pieces[y][x][0][0];\n    const oppColor = color === 'w' ? 'b' : 'w';\n    const dX = toX - x;\n    const dY = toY - y;\n    const enPassant = this.specialMoves[color].enPassant;\n    if (color === 'w' && dY > 0 || color === 'b' && dY< 0) {\n      return false;\n    } else if (Math.abs(dX) === 1 && Math.abs(dY) === 1 &&\n      pieces[toY][toX][0][0] !== color &&\n      pieces[toY][toX][0][0] !== 'n') {\n        return true;\n      } else if (enPassant.status) {\n        if (pawn[0] === enPassant.pos[0] && pawn[1] === enPassant.pos[1] &&\n          toX === x + enPassant.pos[2] && Math.abs(dY) === 1) {\n            return true;\n        }\n      }\n    return false;\n  },\n\n  notInCheck (toX, toY, from, pieces) {\n    let color = pieces[from[1]][from[0]][0][0];\n    let testBoard = this.dupe(pieces);\n    let afterMove = this.testMove(testBoard, from, [toX, toY]);\n    let king = this.findKing(afterMove,color); //[y,x];\n    if (this.findAttackers(king,afterMove,color==='w'?'b':'w',false).length > 0) {\n      return false;\n    } else {\n      return true;\n    }\n  },\n\n  findAttackers (piece, board, colorToCheck, sameSide) {\n    if (!piece) return false;\n    let yDir = colorToCheck === 'w' ? piece[1] + 1 : piece[1] - 1;\n    let left = piece[0] - 1;\n    let right = piece[0] + 1;\n    let returnResult = [];\n    //test for pawns\n    if (left >= 0 && left <= 7 && yDir >= 0 && yDir <= 7 &&\n      board[yDir][left][0] === `${colorToCheck}-p`) {\n      returnResult.push([true,'p']);\n    } else if (right >= 0 && right <= 7 && yDir >= 0 && yDir <= 7 &&\n      board[yDir][right][0] === `${colorToCheck}-p`) {\n      returnResult.push([true, 'p']);\n    }\n    //test for knights\n    [[1,2],[1,-2],[-1,2],[-1,-2],[2,1],[2,-1],[-2,1],[-2,-1]].forEach(coord => {\n      let x = piece[0] + coord[0];\n      let y = piece[1] + coord[1];\n      if (x >= 0 && x <=7 && y >= 0 && y <= 7) {\n        if (board[y][x][0] === `${colorToCheck}-n`) {\n          returnResult.push([true, 'n']);\n        }\n      }\n    });\n    //test for bishops/queens\n    [[1,1],[1,-1],[-1,1],[-1,-1]].forEach(step => {\n      let x = piece[0] + step[0],\n        y = piece[1] + step[1];\n      while (x >= 0 && x <= 7 && y >= 0 && y <= 7) {\n        if (board[y][x][0] === `${colorToCheck}-b` &&\n          this.checkObstruction(x,y,piece,board,sameSide)) {\n          returnResult.push([true, 'b']);\n        } else if (board[y][x][0] === `${colorToCheck}-q` &&\n          this.checkObstruction(x,y,piece,board,sameSide)) {\n          returnResult.push([true, 'q']);\n        }\n        x += step[0];\n        y += step[1];\n      }\n    });\n    //test for rooks/queens\n    [[0,1],[0,-1],[-1,0],[1,0]].forEach(step => {\n      let x = piece[0] + step[0],\n        y = piece[1] + step[1];\n      while (x >= 0 && x <= 7 && y >= 0 && y <= 7) {\n        if (board[y][x][0] === `${colorToCheck}-r` &&\n          this.checkObstruction(x,y,piece,board,sameSide)) {\n          returnResult.push([true, 'r']);\n        } else if (board[y][x][0] === `${colorToCheck}-q` &&\n          this.checkObstruction(x,y,piece,board,sameSide)) {\n          returnResult.push([true,'q']);\n        }\n        x += step[0];\n        y += step[1];\n      }\n    });\n\n    //test for king\n    [[0,1],[0,-1],[-1,0],[1,0],[1,1],[1,-1],[-1,1],[-1,-1]].forEach(coord => {\n      let x = piece[0] + coord[0];\n      let y = piece[1] + coord[1];\n      if (x >= 0 && x <= 7 && y >= 0 && y <= 7) {\n        if (board[y][x][0] === `${colorToCheck}-k`) {\n          returnResult.push([true, 'k']);\n        }\n      }\n    });\n    return returnResult;\n  },\n\n  testMove (testBoard, from, to) {\n    let selected = from;\n    let start = testBoard[selected[1]][selected[0]][0];\n    let color = start[0];\n    if (testBoard[to[1]][to[0]][0][0] !== color) {\n      testBoard[to[1]][to[0]][0] = start;\n      testBoard[selected[1]][selected[0]][0] = 'n-l';\n    }\n    return testBoard;\n  },\n\n  dupe (array) {\n    const duped = [[],[],[],[],[],[],[],[]];\n    for (let i=0;i<array.length;i++) {\n      for (let j=0;j<array[i].length;j++) {\n        let piece = `${array[i][j][0][0]}-${array[i][j][0][2]}`;\n        duped[i].push([piece]);\n      }\n    }\n    return duped;\n  },\n\n  findKing (pieces,color) {\n    const target = `${color}-k`;\n    for (let i=0; i<=7;i++) {\n      for (let j=0; j<=7;j++) {\n        if (pieces[i][j][0] === target) {\n          return [j, i];\n        }\n      }\n    }\n  },\n\n  checkMove (toX, toY, pieces, from) {\n    let pos = from;\n    let piece = pieces[pos[1]][pos[0]][0];\n    let color = pieces[pos[1]][pos[0]][0][0];\n    if (piece[2] === 'n') {\n      if (pieces[toY][toX][0][0] !== color) {\n        return this.knightMoves(pos,toX, toY);\n      }\n    } else if (piece[2] === 'b') {\n      if (this.checkObstruction(toX, toY, pos, pieces)) {\n        return this.bishopMoves(pos,toX, toY);\n      }\n    } else if (piece[2] === 'r') {\n      if (this.checkObstruction(toX, toY, pos, pieces)) {\n        return this.rookMoves(pos,toX, toY);\n      }\n    } else if (piece[2] === 'q') {\n      if (this.checkObstruction(toX, toY, pos, pieces)) {\n        return this.queenMoves(pos,toX, toY);\n      }\n    } else if (piece[2] === 'k') {\n      if (this.checkObstruction(toX, toY, pos, pieces)) {\n        if (this.checkCastle(pos, toX, toY, pieces)) {\n          return true;\n        } else {\n          return this.kingMoves(pos,toX, toY);\n        }\n      }\n    } else if (piece[2] === 'p') {\n      if (this.checkPawnCaptures(toX, toY, pos, pieces)) {\n        return true;\n      } else if (this.checkPawnObstruction(toX, toY, pieces)) {\n        return this.pawnMoves(toX, toY, pos, pieces);\n      }\n    }\n  },\n\n  checkPawnObstruction (toX, toY, pieces) {\n    if (pieces[toY][toX][0][0] !== 'n') {\n      return false;\n    }\n    return true;\n  },\n\n  checkCastle (pos, toX, toY, pieces) {\n    if (pos[0] !== 4) return false;\n\n    let king = [pos[1],pos[0]];\n    let color = pieces[pos[1]][pos[0]][0][0];\n    if (this.findAttackers(king,pieces,color==='w'?'b':'w',false).length > 0) {\n      return false;\n    }\n    if (toX === 2 && toY === pos[1] && this.checkObstruction(toX - 1, toY, pos, pieces) &&\n        this.notInCheck(toX + 1, toY, pos, pieces) &&\n        this.findAttackers(king, pieces, color === 'w' ? 'b' : 'w',false).length === 0) {\n      return this.specialMoves[color].castleQueenSideStatus;\n    } else if (toX === 6 && toY === pos[1] && this.checkObstruction(toX, toY, pos, pieces) &&\n        this.notInCheck(toX - 1, toY, pos, pieces) &&\n        this.findAttackers(king, pieces, color === 'w' ? 'b' : 'w',false).length === 0) {\n      return this.specialMoves[color].castleKingSideStatus;\n    }\n  },\n\n  checkObstruction (toX, toY, from, pieces, sameSide = false) {\n    const [x, y] = from;\n    const color = pieces[y][x][0][0];\n    const dX = toX - x;\n    const dY = toY - y;\n    const xStep = dX / Math.abs(dX) || 0;\n    const yStep = dY / Math.abs(dY) || 0;\n    if (dX === 0 && dY !== 0) {\n      for (let i = 1; i <= Math.abs(dY);i++) {\n        if (pieces[y+(yStep*i)][x][0][0] === color && !sameSide ||\n          (pieces[y+(yStep*i)][x][0][0] !== 'n' && i < Math.abs(dY))) {\n          return false;\n        }\n      }\n      return true;\n    } else if (dY === 0  && dX !== 0) {\n      for (let i = 1; i <= Math.abs(dX);i++) {\n        if (pieces[y][x+(xStep*i)][0][0] === color && !sameSide ||\n          (pieces[y][x+(xStep*i)][0][0] !== 'n' && i < Math.abs(dX))) {\n          return false;\n        }\n      }\n      return true;\n    } else if (Math.abs(dX) / Math.abs(dY) === 1) {\n      for (let i = 1; i <= Math.abs(dX);i++) {\n        if (pieces[y+(yStep*i)][x+(xStep*i)][0][0] === color && !sameSide ||\n          (pieces[y+(yStep*i)][x+(xStep*i)][0][0] !== 'n' && i < Math.abs(dX))) {\n          return false;\n        }\n      }\n\n      return true;\n    } else {\n      return false;\n    }\n  },\n\n  castleRook (toX, toY, pieces) {\n    let start = toX > 4 ? [7, toY] : [0, toY];\n    let piece = pieces[start[1]][start[0]][0];\n    pieces[toY][toX][0] = piece;\n    pieces[start[1]][start[0]][0] = 'n-l';\n  },\n\n  checkEnPassant (toX, toY, from, pieces) {\n    const [x, y] = from;\n    const color = pieces[y][x][0][0];\n    const oppColor = color === 'w' ? 'b' : 'w';\n    const rightSide = toX < 7 ? pieces[toY][toX + 1][0] : ['n-l'];\n    const leftSide = toX > 0 ? pieces[toY][toX - 1][0] : ['n-l'];\n    this.specialMoves[oppColor].enPassant = {status: false, pos: []};\n    if (leftSide[2] === 'p' && leftSide[0] === oppColor) {\n      this.specialMoves[oppColor].enPassant = {status: true, pos: [toX - 1, toY, 1]};\n    } else if (rightSide[2] === 'p' && rightSide[0] === oppColor) {\n      this.specialMoves[oppColor].enPassant = {status: true, pos: [toX + 1, toY, -1]};\n    }\n  },\n\n  captureEnPassant (x, y, pieces) {\n    pieces[y][x][0] = 'n-l';\n  },\n\n  pawnMoves (toX, toY, from, pieces) {\n    const [x, y] = from;\n    const color = pieces[y][x][0][0];\n    const dx = color === 'w' ? toX - x : x - toX;\n    const dy = color === 'w' ? toY - y : y - toY;\n    return (\n      (dx === 0 && dy === -1) ||\n      (y === 6 && dy === -2 && dx === 0 && pieces[5][x][0][0] === 'n') ||\n      (y === 1 && dy === -2 && dx === 0 && pieces[2][x][0][0] === 'n') ||\n      this.checkPawnCaptures(toX, toY, from, pieces)\n    );\n  }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./logic/ai.js"],"sourceRoot":""}